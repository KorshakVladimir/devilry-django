{% extends "devilry/examiner/base.django.html" %}
{% comment %} vim: set ts=2 sts=2 et sw=2: {% endcomment %}
{% load i18n %}
{% load markup %}

{% block title %}{{ assignment_group.parentnode.short_name }}{% endblock %}
{% block heading %}{{ assignment_group.parentnode }}{% endblock %}

{% block breadcrumbs %}
{{ block.super }}
<li><a href='{% url devilry-examiner-list_assignmentgroups assignment_group.parentnode.id %}'>
{{ assignment_group.parentnode }}</a></li>
<li>::</li>
<li>{{ assignment_group.get_students }}</li>
{% endblock %}


{% block content %}

<script type="text/javascript">
  $(function() {
    $(".accordion").accordion({
      autoHeight: false,
      navigation: true,
      collapsible: true,
      active: false,
    });
  });
</script>


<table class='vertical_infotable'>
  <tr>
    <th>{% trans "Deadline" %}:</th>
    <td>{{ assignment_group.parentnode.deadline }}</td>
  </tr>
  <tr>
    <th>{% trans "Status" %}:</th>
    <td>{{ assignment_group.get_status }}</td>
  </tr>

  {% if assignment_group.get_grade %}
  <tr>
    <th>{% trans "Grade" %}:</th>
    <td>{{ assignment_group.get_grade }}</td>
  </tr> 
  {% endif %}

  {% if assignment_group.students.count > 1 %}
    <tr>
      <th>{% trans "Group members" %}:</th>
      <td>{{ assignment_group.students.all|join:", " }} </td>
    </tr>
  {% endif %}
</table>


{% if assignment_group.get_number_of_deliveries > 0 %}
  <h2>{% trans "Deliveries" %}</h2>
  <div class="accordion">
  {% for delivery in assignment_group.deliveries.all %}
    <h3><a href="#">
      {{ delivery.time_of_delivery }}
      {% spaceless %}
        (
        {% if delivery.feedback %}
          {{ delivery.feedback.get_grade }}
        {% else %}
          {% trans "Not corrected" %}
        {% endif %}
        )
      {% endspaceless %}
    </a></h3>
    <div>
      <p>
        <a href='{% url devilry-examiner-correct_delivery delivery.id %}'>
          {% if delivery.feedback %}
            {% trans "Edit feedback" %}
          {% else %}
            {% trans "Create feedback" %}
          {% endif %}
        </a>
      </p>
      {% if delivery.feedback %}
        {% include "devilry/ui/include/show_feedback.django.html" %}
      {% endif %}
    </div>
  {% endfor %}
  </div>
{% endif %}


{% endblock %}
