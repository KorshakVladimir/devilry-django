{% extends "devilry/student/base.django.html" %}
{% comment %} vim: set ts=2 sts=2 et sw=2: {% endcomment %}
{% load i18n %}
{% load inlinestyles %}


{% block breadcrumbs %}
  {{ block.super }}
  <li class="current"><a href="#">
    {{ assignment_group }}
  </a></li>
{% endblock %}

{% block belowheading %}
  {% trans "Overview" %}
{% endblock %}

{% block main %}
{% if assignment_group.status != STATUS_NO_DELIVERIES %}
  <div class='info-message'>
    {% if assignment_group.status == STATUS_CORRECTED_AND_PUBLISHED %}
      {% blocktrans with assignment_group.get_grade_as_short_string|strong as grade and assignment_group|student_status|lower as status_published %}
        This assignment has been {{ status_published }}, and your grade is {{ grade }}.
      {% endblocktrans %}
    {% else %}
      {% with assignment_group|student_status|lower as status_not_corrected %}
        {% if assignment_group.get_active_deadline.is_old %}
          {% blocktrans %}
            The deadline on this assignment has expired.
          {% endblocktrans %}
        {% else %}
          {% blocktrans %}
            The deadline has not expired yet, so you can still add as many
            deliveries as you like.
          {% endblocktrans %}
        {% endif %}
      {% endwith %}
    {% endif %}
   </div>
 {% endif %}
 
 <h2>{% trans "Deliveries" %}</h2>
  <p class="unimportant">
    {% blocktrans %}
      Current deliveries, with the latest delivery first.
    {% endblocktrans %}
    {% if not assignment_group.can_add_deliveries %}
      {% trans "You can not add any more deliveries on this assignment." %}
    {% endif %}
  </p>
  {% if assignment_group.deliveries.all.count == 0 %}
    <p class="no_deliveries">{% trans "No deliveries" %}</p>
  {% else %}
    <table class='horizontal_ordered_table'>
    <tr>
      <th>Time</th>
	  <th>Deadline</th>
      <th>Delivered by</th>
      <th>Status</th>
      <th>Grade</th>
      <th></th>
    </tr>
    
    {% for delivery in assignment_group.deliveries.all %}
    <tr>
      <td> {{ delivery.time_of_delivery|date:"DATETIME_FORMAT" }} </td>
	  <td> {{ delivery.deadline_tag }} </td>
      <td> {{ delivery.delivered_by }} </td>
      <td>
        {{ delivery|student_status }}
      </td>
      <td> {% if delivery.feedback.published %}
      {{ delivery.feedback.get_grade_as_short_string }} {% endif %} 
      </td>
      <td><a href='{% url devilry-student-show-delivery delivery.id %}'>
            show
      </a></td>
    </tr>
    {% endfor %}
    </table> 
  {% endif %}

  {% if assignment_group.can_add_deliveries %}
  <p>
    <a class='button' href='{% url devilry-student-add-delivery assignment_group.id %}'>
      Add new delivery
    </a>
  </p>
  {% endif %}
{% endblock %}


