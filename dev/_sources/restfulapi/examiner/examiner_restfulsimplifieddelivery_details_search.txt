.. _examiner_restfulsimplifieddelivery_details_search:

=============================================================================
GET /examiner/restfulsimplifieddelivery/
=============================================================================

Search for Deliveries.

The underlying data model searched is defined in :class:`devilry.apps.core.models.Delivery`.
The :ref:`simplified` that the server forwards this request to is
:meth:`devilry.apps.examiner.simplified.SimplifiedDelivery.search`.

The request parameters (below) all modify the result of the search. They are
applied in the following order:

    1. The ``query`` is executed.
    2. The result of the query is filtered through the ``filters``.
    3. The result of the filtering is ordered as specified in ``orderby``.
    4. The result of the ordering is limited by ``start`` and ``limit``.


**************************
Request
**************************

Request example
###############

.. code-block:: javascript

    GET /examiner/restfulsimplifieddelivery/

    {
        query: 'a query string',
        filters: [{field:"deadline", comp:"iexact", value:15},
                      {field:"deadline__assignment_group", comp:"contains", value:15},
                      {field:"deadline__assignment_group__name", comp:">", value:"My example value"}],
        orderby: ["id", "-number", "time_of_delivery", "deadline", "successful", "delivery_type", "alias_delivery"],
        start: 10,
        limit: 100
    }



Optional request parameters
###########################

Optional request parameters are encoded as a JSON object and sent as the
request body as shown in the example above.

query
-----
A string to search for. If this is empty or not given, all
Deliveries that the authenticated user has access to is
returned.

If the string is not empty, the ``query``-string is split on whitespace,
resulting in a list of words. Every *word* in the list is searched for
*case-insensitive* matches within the following fields:

    
        number
            Actual location of the field:
                :class:`devilry.apps.core.models.Delivery`
            About the field:
                The delivery-number within this assignment-group. This number is automatically incremented within each AssignmentGroup, starting from 1. Always unique within the assignment-group.
            Type
                Integer
    
        deadline__assignment_group__name
            Actual location of the field:
                :class:`devilry.apps.core.models.AssignmentGroup`
            About the field:
                An optional name for the group. Typically used a project name on project assignments.
            Type
                String
    
        deadline__assignment_group__candidates__identifier
            Actual location of the field:
                :class:`devilry.apps.core.models.Candidate`
            About the field:
                List of many values.
            Type
                List of strings
    
        deadline__assignment_group__parentnode__short_name
            Actual location of the field:
                :class:`devilry.apps.core.models.Assignment`
            About the field:
                Max 20 characters. Only numbers, lowercase characters, '_' and '-'. 
            Type
                String
    
        deadline__assignment_group__parentnode__long_name
            Actual location of the field:
                :class:`devilry.apps.core.models.Assignment`
            About the field:
                A longer name, more descriptive than "Short name". This is the name visible to students.
            Type
                String
    
        deadline__assignment_group__parentnode__parentnode__short_name
            Actual location of the field:
                :class:`devilry.apps.core.models.Period`
            About the field:
                Max 20 characters. Only numbers, lowercase characters, '_' and '-'. 
            Type
                String
    
        deadline__assignment_group__parentnode__parentnode__long_name
            Actual location of the field:
                :class:`devilry.apps.core.models.Period`
            About the field:
                A longer name, more descriptive than "Short name". This is the name visible to students.
            Type
                String
    
        deadline__assignment_group__parentnode__parentnode__parentnode__short_name
            Actual location of the field:
                :class:`devilry.apps.core.models.Subject`
            About the field:
                Max 20 characters. Only numbers, lowercase characters, '_' and '-'. 
            Type
                String
    
        deadline__assignment_group__parentnode__parentnode__parentnode__long_name
            Actual location of the field:
                :class:`devilry.apps.core.models.Subject`
            About the field:
                A longer name, more descriptive than "Short name". This is the name visible to students.
            Type
                String
    





filters
-------

Filters can be used to perform complex queries. The ``filters`` parameter is a
list of filters, where each filter is a map with the following entries:

    field
        A field name.
    comp
        A comparison operator.
    value
        The value to filter on.

Example:

    .. code-block:: javascript

        [{field:"deadline", comp:"iexact", value:15},
         {field:"deadline__assignment_group", comp:"contains", value:15},
         {field:"deadline__assignment_group__name", comp:">", value:"My example value"}]

Deliveries can be filtered on the following *fields*:


    deadline
        Actual location of the field:
            :class:`devilry.apps.core.models.Deadline`
        About the field:
            Autogenerated identifier.
        Type
            Integer
        Supported comparison operators:
            ``startswith``, ``contains``, ``>=``, ``<=``, ``icontains``, ``iexact``, ``endswith``, ``exact``, ``<``, ``>``.

    deadline__assignment_group
        Actual location of the field:
            :class:`devilry.apps.core.models.AssignmentGroup`
        About the field:
            Autogenerated identifier.
        Type
            Integer
        Supported comparison operators:
            ``startswith``, ``<=``, ``>=``, ``contains``, ``icontains``, ``iexact``, ``endswith``, ``exact``, ``<``, ``>``.

    deadline__assignment_group__name
        Actual location of the field:
            :class:`devilry.apps.core.models.AssignmentGroup`
        About the field:
            An optional name for the group. Typically used a project name on project assignments.
        Type
            String
        Supported comparison operators:
            ``startswith``, ``<=``, ``>=``, ``contains``, ``icontains``, ``iexact``, ``endswith``, ``exact``, ``<``, ``>``.

    deadline__assignment_group__parentnode
        Actual location of the field:
            :class:`devilry.apps.core.models.Assignment`
        About the field:
            Autogenerated identifier.
        Type
            Integer
        Supported comparison operators:
            ``startswith``, ``<=``, ``>=``, ``contains``, ``icontains``, ``iexact``, ``endswith``, ``exact``, ``<``, ``>``.

    deadline__assignment_group__parentnode__delivery_types
        Actual location of the field:
            :class:`devilry.apps.core.models.Assignment`
        About the field:
            This option controls what types of deliveries this assignment accepts. See docs for Delivery for documentation of accepted values.
        Type
            Integer
        Supported comparison operators:
            ``startswith``, ``<=``, ``>=``, ``contains``, ``icontains``, ``iexact``, ``endswith``, ``exact``, ``<``, ``>``.

    deadline__assignment_group__parentnode__long_name
        Actual location of the field:
            :class:`devilry.apps.core.models.Assignment`
        About the field:
            A longer name, more descriptive than "Short name". This is the name visible to students.
        Type
            String
        Supported comparison operators:
            ``startswith``, ``<=``, ``>=``, ``contains``, ``icontains``, ``iexact``, ``endswith``, ``exact``, ``<``, ``>``.

    deadline__assignment_group__parentnode__parentnode
        Actual location of the field:
            :class:`devilry.apps.core.models.Period`
        About the field:
            Autogenerated identifier.
        Type
            Integer
        Supported comparison operators:
            ``startswith``, ``<=``, ``>=``, ``contains``, ``icontains``, ``iexact``, ``endswith``, ``exact``, ``<``, ``>``.

    deadline__assignment_group__parentnode__parentnode__end_time
        Actual location of the field:
            :class:`devilry.apps.core.models.Period`
        About the field:
            Start time and end time defines when the period is active.
        Type
            DateTime string (YYYY-MM-DD hh:mm:ss)
        Supported comparison operators:
            ``startswith``, ``<=``, ``>=``, ``contains``, ``icontains``, ``iexact``, ``endswith``, ``exact``, ``<``, ``>``.

    deadline__assignment_group__parentnode__parentnode__long_name
        Actual location of the field:
            :class:`devilry.apps.core.models.Period`
        About the field:
            A longer name, more descriptive than "Short name". This is the name visible to students.
        Type
            String
        Supported comparison operators:
            ``startswith``, ``<=``, ``>=``, ``contains``, ``icontains``, ``iexact``, ``endswith``, ``exact``, ``<``, ``>``.

    deadline__assignment_group__parentnode__parentnode__parentnode
        Actual location of the field:
            :class:`devilry.apps.core.models.Subject`
        About the field:
            Autogenerated identifier.
        Type
            Integer
        Supported comparison operators:
            ``startswith``, ``<=``, ``>=``, ``contains``, ``icontains``, ``iexact``, ``endswith``, ``exact``, ``<``, ``>``.

    deadline__assignment_group__parentnode__parentnode__parentnode__long_name
        Actual location of the field:
            :class:`devilry.apps.core.models.Subject`
        About the field:
            A longer name, more descriptive than "Short name". This is the name visible to students.
        Type
            String
        Supported comparison operators:
            ``startswith``, ``<=``, ``>=``, ``contains``, ``icontains``, ``iexact``, ``endswith``, ``exact``, ``<``, ``>``.

    deadline__assignment_group__parentnode__parentnode__parentnode__parentnode
        Actual location of the field:
            :class:`devilry.apps.core.models.Node`
        About the field:
            Autogenerated identifier.
        Type
            Integer
        Supported comparison operators:
            ``startswith``, ``<=``, ``>=``, ``contains``, ``icontains``, ``iexact``, ``endswith``, ``exact``, ``<``, ``>``.

    deadline__assignment_group__parentnode__parentnode__parentnode__short_name
        Actual location of the field:
            :class:`devilry.apps.core.models.Subject`
        About the field:
            Max 20 characters. Only numbers, lowercase characters, '_' and '-'. 
        Type
            String
        Supported comparison operators:
            ``startswith``, ``<=``, ``>=``, ``contains``, ``icontains``, ``iexact``, ``endswith``, ``exact``, ``<``, ``>``.

    deadline__assignment_group__parentnode__parentnode__short_name
        Actual location of the field:
            :class:`devilry.apps.core.models.Period`
        About the field:
            Max 20 characters. Only numbers, lowercase characters, '_' and '-'. 
        Type
            String
        Supported comparison operators:
            ``startswith``, ``<=``, ``>=``, ``contains``, ``icontains``, ``iexact``, ``endswith``, ``exact``, ``<``, ``>``.

    deadline__assignment_group__parentnode__parentnode__start_time
        Actual location of the field:
            :class:`devilry.apps.core.models.Period`
        About the field:
            Start time and end time defines when the period is active.
        Type
            DateTime string (YYYY-MM-DD hh:mm:ss)
        Supported comparison operators:
            ``startswith``, ``<=``, ``>=``, ``contains``, ``icontains``, ``iexact``, ``endswith``, ``exact``, ``<``, ``>``.

    deadline__assignment_group__parentnode__short_name
        Actual location of the field:
            :class:`devilry.apps.core.models.Assignment`
        About the field:
            Max 20 characters. Only numbers, lowercase characters, '_' and '-'. 
        Type
            String
        Supported comparison operators:
            ``startswith``, ``<=``, ``>=``, ``contains``, ``icontains``, ``iexact``, ``endswith``, ``exact``, ``<``, ``>``.

    deadline__deadline
        Actual location of the field:
            :class:`devilry.apps.core.models.Deadline`
        About the field:
            The time of the deadline.
        Type
            DateTime string (YYYY-MM-DD hh:mm:ss)
        Supported comparison operators:
            ``startswith``, ``<=``, ``>=``, ``contains``, ``icontains``, ``iexact``, ``endswith``, ``exact``, ``<``, ``>``.

    delivery_type
        Actual location of the field:
            :class:`devilry.apps.core.models.Delivery`
        About the field:
            0: Electronic delivery, 1: Non-electronic delivery, 2: Alias delivery. Default: 0.
        Type
            Integer
        Supported comparison operators:
            ``startswith``, ``contains``, ``>=``, ``<=``, ``icontains``, ``iexact``, ``endswith``, ``exact``, ``<``, ``>``.

    id
        Actual location of the field:
            :class:`devilry.apps.core.models.Delivery`
        About the field:
            Autogenerated identifier.
        Type
            Integer
        Supported comparison operators:
            ``startswith``, ``contains``, ``>=``, ``<=``, ``icontains``, ``iexact``, ``endswith``, ``exact``, ``<``, ``>``.

    time_of_delivery
        Actual location of the field:
            :class:`devilry.apps.core.models.Delivery`
        About the field:
            Holds the date and time the Delivery was uploaded.
        Type
            DateTime string (YYYY-MM-DD hh:mm:ss)
        Supported comparison operators:
            ``startswith``, ``contains``, ``>=``, ``<=``, ``icontains``, ``iexact``, ``endswith``, ``exact``, ``<``, ``>``.







exact_number_of_results
-----------------------
If given, this must be a positive integer (including 0), which specifies the exact number of
expected results. This enables searches that you know should fail if they do not get this
exact number of results, such as filtering for a User by unique username
instead of its numeric ID (where you should expect exactly one result).


orderby
-------
List of fieldnames. Order the result by these fields.
Fieldnames can be prefixed by ``'-'`` for descending ordering.

start
-----
After query, filters and orderby have been executed, the result is limited to
the values from *start* to *start+limit*. Start defalts to ``0``.

limit
-----
Limit results to this number of items. Defaults to ``50``.


result_fieldgroups
------------------
A list of group names. Each group adds an additional set of fields to the
results of the search. The following group names are available:

    assignment_group_users
        *Expands to the following fields:*
        
            deadline__assignment_group__candidates__identifier
                Actual location of the field:
                    :class:`devilry.apps.core.models.Candidate`
                About the field:
                    List of many values.
                Type
                    List of strings
        

    assignment
        *Expands to the following fields:*
        
            deadline__assignment_group__parentnode
                Actual location of the field:
                    :class:`devilry.apps.core.models.Assignment`
                About the field:
                    Autogenerated identifier.
                Type
                    Integer
        
            deadline__assignment_group__parentnode__delivery_types
                Actual location of the field:
                    :class:`devilry.apps.core.models.Assignment`
                About the field:
                    This option controls what types of deliveries this assignment accepts. See docs for Delivery for documentation of accepted values.
                Type
                    Integer
        
            deadline__assignment_group__parentnode__short_name
                Actual location of the field:
                    :class:`devilry.apps.core.models.Assignment`
                About the field:
                    Max 20 characters. Only numbers, lowercase characters, '_' and '-'. 
                Type
                    String
        
            deadline__assignment_group__parentnode__long_name
                Actual location of the field:
                    :class:`devilry.apps.core.models.Assignment`
                About the field:
                    A longer name, more descriptive than "Short name". This is the name visible to students.
                Type
                    String
        

    period
        *Expands to the following fields:*
        
            deadline__assignment_group__parentnode__parentnode
                Actual location of the field:
                    :class:`devilry.apps.core.models.Period`
                About the field:
                    Autogenerated identifier.
                Type
                    Integer
        
            deadline__assignment_group__parentnode__parentnode__start_time
                Actual location of the field:
                    :class:`devilry.apps.core.models.Period`
                About the field:
                    Start time and end time defines when the period is active.
                Type
                    DateTime string (YYYY-MM-DD hh:mm:ss)
        
            deadline__assignment_group__parentnode__parentnode__end_time
                Actual location of the field:
                    :class:`devilry.apps.core.models.Period`
                About the field:
                    Start time and end time defines when the period is active.
                Type
                    DateTime string (YYYY-MM-DD hh:mm:ss)
        
            deadline__assignment_group__parentnode__parentnode__short_name
                Actual location of the field:
                    :class:`devilry.apps.core.models.Period`
                About the field:
                    Max 20 characters. Only numbers, lowercase characters, '_' and '-'. 
                Type
                    String
        
            deadline__assignment_group__parentnode__parentnode__long_name
                Actual location of the field:
                    :class:`devilry.apps.core.models.Period`
                About the field:
                    A longer name, more descriptive than "Short name". This is the name visible to students.
                Type
                    String
        

    delivered_by
        *Expands to the following fields:*
        
            delivered_by__identifier
                Actual location of the field:
                    :class:`devilry.apps.core.models.Candidate`
                About the field:
                    The candidate_id if this is a candidate on an anonymous assignment, and username if not.
                Type
                    String
        

    deadline
        *Expands to the following fields:*
        
            deadline__deadline
                Actual location of the field:
                    :class:`devilry.apps.core.models.Deadline`
                About the field:
                    The time of the deadline.
                Type
                    DateTime string (YYYY-MM-DD hh:mm:ss)
        

    assignment_group
        *Expands to the following fields:*
        
            deadline__assignment_group
                Actual location of the field:
                    :class:`devilry.apps.core.models.AssignmentGroup`
                About the field:
                    Autogenerated identifier.
                Type
                    Integer
        
            deadline__assignment_group__name
                Actual location of the field:
                    :class:`devilry.apps.core.models.AssignmentGroup`
                About the field:
                    An optional name for the group. Typically used a project name on project assignments.
                Type
                    String
        

    candidates
        *Expands to the following fields:*
        
            deadline__assignment_group__candidates__identifier
                Actual location of the field:
                    :class:`devilry.apps.core.models.Candidate`
                About the field:
                    List of many values.
                Type
                    List of strings
        

    subject
        *Expands to the following fields:*
        
            deadline__assignment_group__parentnode__parentnode__parentnode
                Actual location of the field:
                    :class:`devilry.apps.core.models.Subject`
                About the field:
                    Autogenerated identifier.
                Type
                    Integer
        
            deadline__assignment_group__parentnode__parentnode__parentnode__short_name
                Actual location of the field:
                    :class:`devilry.apps.core.models.Subject`
                About the field:
                    Max 20 characters. Only numbers, lowercase characters, '_' and '-'. 
                Type
                    String
        
            deadline__assignment_group__parentnode__parentnode__parentnode__long_name
                Actual location of the field:
                    :class:`devilry.apps.core.models.Subject`
                About the field:
                    A longer name, more descriptive than "Short name". This is the name visible to students.
                Type
                    String
        










*********************
Response
*********************

On success
##########


Example
------------------------

*note that the is wrong in the example. The id is always unique. However, the
example is generated from a non-varying dataset.*

.. code-block:: javascript

    200 OK

    {
        total: 20,
        items: [
            { id: 15,
              number: 20,
              time_of_delivery: "2010-02-22 22:32:10",
              deadline: 15,
              successful: true,
              delivery_type: 20,
              alias_delivery: 15 },
            { id: 15,
              number: 20,
              time_of_delivery: "2010-02-22 22:32:10",
              deadline: 15,
              successful: true,
              delivery_type: 20,
              alias_delivery: 15 },
            ...
        ]
    }


Success response details
------------------------

Responds with HTTP code *200* and a *JSON encoded* dict containing the list of
results and the *total* number of items found before applying ``limit`` and
``start``. Each result in the
list is a JSON object where the *key* is a fieldname and the associated value is
the *value* for that field. The result always contains the following fields:

    
        id
            Actual location of the field:
                :class:`devilry.apps.core.models.Delivery`
            About the field:
                Autogenerated identifier.
            Type
                Integer
    
        number
            Actual location of the field:
                :class:`devilry.apps.core.models.Delivery`
            About the field:
                The delivery-number within this assignment-group. This number is automatically incremented within each AssignmentGroup, starting from 1. Always unique within the assignment-group.
            Type
                Integer
    
        time_of_delivery
            Actual location of the field:
                :class:`devilry.apps.core.models.Delivery`
            About the field:
                Holds the date and time the Delivery was uploaded.
            Type
                DateTime string (YYYY-MM-DD hh:mm:ss)
    
        deadline
            Actual location of the field:
                :class:`devilry.apps.core.models.Deadline`
            About the field:
                Autogenerated identifier.
            Type
                Integer
    
        successful
            Actual location of the field:
                :class:`devilry.apps.core.models.Delivery`
            About the field:
                Has the delivery and all its files been uploaded successfully?
            Type
                Boolean
    
        delivery_type
            Actual location of the field:
                :class:`devilry.apps.core.models.Delivery`
            About the field:
                0: Electronic delivery, 1: Non-electronic delivery, 2: Alias delivery. Default: 0.
            Type
                Integer
    
        alias_delivery
            Actual location of the field:
                :class:`devilry.apps.core.models.Delivery`
            About the field:
                Autogenerated identifier.
            Type
                Integer
    


However, there may be more fields if specified with the ``result_fieldgroups``
request parameter.




On error
########

On errors, we respond with one of the :ref:`restful_api_error_statuscodes`.
