{% extends "devilry_examiner/base.django.html" %}
{% load i18n %}
{% load devilry_examiner_tags %}

{% block bodyid %}singlegroupoverview{% endblock %}

{% block body %}
    <div class="container assignmentheader">
        <h1>
            {% for candidate in group.candidates.all %}
                {% if not forloop.first %}
                    ,
                {% endif %}
                {{ candidate.displayname }}
            {% endfor %}
            &mdash;
            {{ group.assignment.long_name }}
        </h1>
        <div class="subheader">
            {{ group.subject.long_name }} {{ group.period.long_name }}
        </div>

        <div class="alert alert-{{ group|group_delivery_status_to_bootstrapclass }}">
            <strong>{% trans "Status" %}: {{ group.delivery_status|formatted_status }}</strong>
            {% if group.delivery_status == 'corrected' %}
                <p><small>
                    {% trans "Grade" %}: {{ group.feedback.grade }}
                    ({{ group.feedback.is_passing_grade|format_is_passing_grade }})
                </small></p>
            {% endif %}
        </div>
    </div>

    {% for deadline in group.deadlines.all %}
        <div class="container deadline">
            <div class="deadline-header">
                <h2 class="text-muted">
                    {% blocktrans with number=forloop.revcounter %}Deadline {{ number }}{% endblocktrans %}
                </h2>
                <p class="text-muted deadline-datetime">{{ deadline.deadline|date:"DATETIME_FORMAT" }}</p>
            </div>
            <table class="table table-striped infolistingtable">
                {% for delivery in deadline.query_successful_deliveries %}
                    <tr class="delivery delivery-{{ delivery.id }}">
                        <td class="titled-cell">
                            <h3>
                                <a href="#">
                                    {% blocktrans with number=delivery.number %}Delivery #{{ number }}{% endblocktrans %}
                                </a>
                            </h3>
                            {% if delivery.last_feedback %}
                                <p class="text-{{ delivery.last_feedback|feedback_to_bootstrapclass }}">
                                    {{ delivery.last_feedback.grade }}
                                    ({{ delivery.last_feedback.is_passing_grade|format_is_passing_grade }})
                                </p>
                            {% else %}
                                <p class="text-muted">{% trans "No feedback" %}</p>
                            {% endif %}
                        </td>
                        <td class="text-right hidden-xs text-muted">
                            <p class="time_of_delivery">{{ delivery.time_of_delivery|date:"DATETIME_FORMAT" }}</p>
                        </td>
                    </tr>
                {% empty %}
                    <p class="text-warning no-deliveries-message">{% trans "No deliveries" %}</p>
                {% endfor %}
            </table>
        </div>
    {% endfor %}
{% endblock %}
